---
import Layout from '~/layouts/PageLayout.astro';
import PropertyCard2 from '~/components/widgets/PropertyCard2.astro';
import HeadLine from "../components/ui/Headline.astro";

const metadata = {
  title: 'Contacto',
};

let propiedades = [];
try {
  const response = await fetch('https://api-propiedades.vercel.app/api/propiedades');

  if (response.ok) {
    propiedades = await response.json();
  } else {
    console.error('Error al obtener los datos', response.statusText);
  }
} catch (error) {
  console.error('Error en la solicitud fetch', error);
}
---

<Layout metadata={metadata}>
  <HeadLine tagline="PROPIEDADES" title="Nuestras mejores ofertas"/>
  <div class="grid p-5 sm:gap-y-8 lg:grid-cols-3 sm:grid-cols-2 gap-4 md:gap-6">
    {propiedades.map(({
                        id,
                        imagen,
                        especificaciones,
                        precioBaseSoles,
                        precioBaseDolares,
                        tipo,
                        disponibilidad,
                        ubicacion,
                        areaTotal,
                        areaConstruida
                      }) => (
      <PropertyCard2 id={id} imagen={imagen}
                     especificaciones={especificaciones}
                     precioBaseSoles={precioBaseSoles}
                     precioBaseDolares={precioBaseDolares} tipo={tipo}
                     disponibilidad={disponibilidad}
                     ubicacion={ubicacion}
                     areaTotal={areaTotal} areaConstruida={areaConstruida}/>
    ))}
  </div>
</Layout>
